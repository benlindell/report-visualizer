!function t(e,r,s){function n(i,o){if(!r[i]){if(!e[i]){var p="function"==typeof require&&require;if(!o&&p)return p(i,!0);if(a)return a(i,!0);throw new Error("Cannot find module '"+i+"'")}var u=r[i]={exports:{}};e[i][0].call(u.exports,function(t){var r=e[i][1][t];return n(r?r:t)},u,u.exports,t,e,r,s)}return r[i].exports}for(var a="function"==typeof require&&require,i=0;i<s.length;i++)n(s[i]);return n}({1:[function(){},{}],2:[function(t,e){var r,s,n;r=t("react"),s=t("lodash"),n=r.DOM.rect,e.exports=r.createClass({displayName:"Bar",getDefaultProps:function(){return{width:0,height:0,availableHeight:0,offset:0,title:"",fill:"#ccc"}},render:function(){return n({width:this.props.width,height:this.props.height,x:s.isUndefined(this.props.x)?this.props.offset:this.props.x,y:s.isUndefined(this.props.y)?this.props.availableHeight-this.props.height:this.props.y,title:this.props.title,fill:this.props.fill},[])}})},{}],3:[function(t,e){var r,s;r=t("react"),s=r.DOM.svg,e.exports=r.createClass({displayName:"Chart",getDefaultProps:function(){return{width:0,height:0}},render:function(){return s({width:this.props.width,height:this.props.height,className:this.props.className},this.props.children)}})},{}],4:[function(t,e){e.exports={Stacked:t("./stacked"),VerticalBars:t("./verticalBars"),PunchChart:t("./punchchart")}},{"./punchchart":5,"./stacked":6,"./verticalBars":8}],5:[function(t,e){var r,s,n,a,i,o,p,u,c;o=t("lodash"),s=t("react"),c=s.DOM,i=c.g,u=c.text,a=c.circle,p=c.line,r=t("./chart"),n=t("./tooltip"),e.exports=s.createClass({displayName:"PunchChart",getDefaultProps:function(){return{width:200,height:300,padding:{t:0,r:0,b:40,l:40}}},render:function(){var t,e,s,c,l,h,d,f,y,g,v,m,b,k,x,w,C,N;return b=o(this.props.distribution).map(function(t){var e,r,s;return r=t[0],s=t[1],e=t[2],r}).unique().sortBy().value(),N=o(this.props.distribution).map(function(t){var e,r,s;return r=t[0],s=t[1],e=t[2],s}).unique().sortBy().value(),e=o.min(this.props.distribution,function(t){var e,r,s;return r=t[0],s=t[1],e=t[2],e})[2],t=o.max(this.props.distribution,function(t){var e,r,s;return r=t[0],s=t[1],e=t[2],e})[2],d=this.props.padding,l={height:this.props.height-d.t-d.b,width:this.props.width-d.l-d.r},c=Math.floor(l.height/N.length),f=Math.floor(l.width/b.length),h=Math.floor(.9*Math.max(0,Math.min(c,f)/2)),C=function(t){return d.t+c*t},m=function(t){return d.l+f*t},y=p({key:"xAxis",x1:0,x2:this.props.width,y1:l.height+d.t,y2:l.height+d.t,transform:"translate(0.5,0.5)"}),k=p({key:"yAxis",x1:d.l,x2:d.l,y1:0,y2:this.props.height,transform:"translate(0.5,0.5)"}),w=o.map(N,function(t,e){return p({key:e,x1:d.l-5,y1:C(e+1)-c/2,x2:d.l+5,y2:C(e+1)-c/2})}),x=o.map(N,function(t,e){return null==t&&(t=""),u({key:e,x:d.l-10,y:C(e+1)-c/2+5},t)}),v=o.map(b,function(t){return function(e,r){return p({key:r,x1:m(r)+f/2,y1:t.props.height-d.b-5,x2:m(r)+f/2,y2:t.props.height-d.b+5})}}(this)),g=o.map(b,function(t){return function(e,r){return null==e&&(e=""),u({key:r,x:m(r)+f/2,y:t.props.height-d.b+20},e.replace(/^(\d*) /,""))}}(this)),s=o.map(this.props.distribution,function(r,s){var o,p,u,l,d,y;return l=r[0],y=r[1],o=r[2],o>0?(p=Math.max(5,h*(o-e)/Math.max(1,t-e)),isNaN(p)&&(p=5),u=f/2+m(_.indexOf(b,l)),d=c/2+C(_.indexOf(N,y)),i({key:s,className:"dot"},[a({key:"dot",r:p,transform:"translate("+u+", "+d+")",title:""+o}),n({key:"tip",x:u,y:d-p,label:""+o})])):void 0}),r({width:this.props.width,height:this.props.height,className:"chart chart-punchchart"},[y,k,i({key:"labels-y",className:"labels-y"},x),i({key:"markers-y",className:"markers-y"},w),i({key:"labels-x",className:"labels-x"},g),i({key:"markers-x",className:"markers-x"},v),i({key:"values",className:"values"},s)])}})},{"./chart":3,"./tooltip":7}],6:[function(t,e){var r,s,n,a,i,o,p;i=t("lodash"),n=t("react"),p=n.DOM,a=p.g,o=p.text,s=t("../charts/chart"),r=t("../charts/bar"),e.exports=n.createClass({displayName:"StackedChart",getDefaultProps:function(){return{width:200,height:300,fills:["#042d42","#0b84c2","#075075","#57bef2","#326e8c"]}},render:function(){var t,e,n,p;return t=i(this.props.distribution).reduce(function(t,e){return t+e},0),n=function(t){return function(){var e;return e=0,function(){return e+=1,t.props.fills[e%t.props.fills.length]}}}(this)(),p=0,e=i(this.props.distribution).pairs().sortBy(function(t){var e,r;return r=t[0],e=t[1],-1*e}).map(function(e){return function(s,i){var u,c,l,h,d;return d=s[0],h=s[1],c=e.props.height*(h/t),l=o({key:"label",x:5,y:p+15},d),u=r({key:"bar",width:e.props.width,height:c,title:d,fill:n(),y:p},[]),p+=c,a({key:i},[u,l])}}(this)),s({width:this.props.width,height:this.props.height,className:"chart chart-stacked"},e)}})},{"../charts/bar":2,"../charts/chart":3}],7:[function(t,e){var r,s,n,a,i;r=t("react"),i=r.DOM,s=i.g,n=i.rect,a=i.text,e.exports=r.createClass({displayName:"Tooltip",getDefaultProps:function(){return{x:0,y:0,label:""}},render:function(){return s({className:"tooltip",transform:"translate("+this.props.x+","+this.props.y+")"},[n({key:"bg",className:"tooltip-bg",x:-13,y:-14,rx:5,ry:5,height:20,width:10+6*this.props.label.length+10}),a({key:"label",className:"tooltip-label",ref:"label",children:this.props.label})])}})},{}],8:[function(t,e){var r,s,n,a,i,o,p;i=t("lodash"),n=t("react"),p=n.DOM,a=p.div,o=p.p,s=t("../charts/chart"),r=t("../charts/bar"),e.exports=n.createClass({displayName:"VerticalBarChart",getDefaultProps:function(){return{width:200,height:300,lineHeight:5}},render:function(){var t,e;return e=_.max(this.props.distribution,_.identity),t=i(this.props.distribution).pairs().sortBy(function(t){var e,r;return r=t[0],e=t[1],-1*e}).map(function(t){return function(r,s){var n,i,p,u,c;return u=r[0],p=r[1],c=t.props.width*(p/e),i=o({key:"label",className:"chart-vertical-label"},""+u+" ("+p+")"),n=a({key:"bar",className:"chart-vertical-bar",style:{width:c,height:t.props.lineHeight}},[]),a({key:s,className:"chart-vertical-line"},[i,n])}}(this)),a({className:"chart chart-vertical-bars"},t)}})},{"../charts/bar":2,"../charts/chart":3}],9:[function(t,e){var r,s;try{s=JSON.parse(window.sessionStorage.snapshots),console.log("Got "+s.length+" snapshots from local storage.")}catch(n){r=n,s=[]}e.exports=window.data={hasData:!!s.length,snapshots:s,_save:function(){return window.sessionStorage.snapshots=JSON.stringify(this.snapshots)},_clear:function(){return delete window.sessionStorage.snapshots}}},{}],10:[function(t){/*!
 * # Reporter Visualizer
 *
 * @copyright 2014 Pascal Hertleif
 * @license MIT
 */
var e,r,s,n,a,i,o,p,u,c;e=t("react"),c=e.DOM,u=c.section,n=c.div,a=c.h1,o=c.p,r=c.a,s=t("./data"),i=e.createClass({displayName:"Layout",getInitialState:function(){return{hasData:!!s.hasData}},gotData:function(){return this.replaceProps({snapshots:s.snapshots}),this.setState({hasData:!0})},clearCache:function(t){return t.preventDefault(),s._clear(),window.location.reload()},render:function(){var e;return e=[n({key:"top-bar",className:"top-bar"},[a({key:"title"},"Reporter Report Analyser")])],e=e.concat(this.state.hasData?[u({key:"meta",className:"box meta"},[o({key:"meta-p"},[""+this.props.snapshots.length+" snapshots loaded. ",r({key:"clearCache",href:"#clear",onClick:this.clearCache},"Clear Cache")])]),t("./views/charts")({key:"charts",snapshots:this.props.snapshots})]:[t("./loadFiles")({key:"loadFiles",gotData:this.gotData})]),u({className:"main"},e)}}),(p=function(){return e.renderComponent(i({snapshots:s.snapshots}),document.getElementById("container"))})()},{"./data":9,"./loadFiles":11,"./views/charts":14}],11:[function(t,e){var r,s,n,a,i,o,p,u,c,l;p=t("lodash"),r=t("q"),s=t("react"),l=s.DOM,i=l.div,c=l.p,n=l.code,o=l.input,a=t("./data"),u=function(t){var e,s;return e=r.defer(),s=new window.FileReader,s.onload=function(r){var s,n;try{return n=JSON.parse(r.target.result),e.resolve(n)}catch(a){return s=a,s.message="Error parsing "+t.name,e.reject(s)}},s.onerror=function(){return e.reject(new Error("Error reading file "+t.name))},s.onabort=function(){return e.reject(new Error("Aborted reading file "+t.name))},s.readAsText(t),e.promise},e.exports=s.createClass({displayName:"LoadFiles",loadFiles:function(t){var e;return t.preventDefault(),e=t.target.files,(null!=e?e.length:void 0)?r.all(p.map(e,u)).then(function(t){return function(e){var r,s;s=p(e).map(function(t){return t.snapshots}).flatten().value();try{return a.hasData=!0,a.snapshots=s,a._save(),t.props.gotData()}catch(n){return r=n,console.error(r.stack)}}}(this)).fail(function(t){return window.alert("Failed to load files."),console.error(t)}):console.log("No files")},render:function(){return i({className:"box load-files"},c({key:"help"},["Just select all the files Reporter saved to your Dropbox. They are probably\nin a folder called ",n({},"~/Dropbox/Apps/Reporter-App"),"."]),c({key:"server-info"},"Your data will not be uploaded to any server, it will only be\nstored and processed by the browser you are currently using."),c({key:"input"},o({type:"file",multiple:!0,onChange:this.loadFiles})))}})},{"./data":9,q:"GOrh4h"}],12:[function(t,e,r){var r,s;s=t("lodash"),r=e.exports,r.getAnswersFromResponse=function(t){var e,r;return e=t.answeredOptions||t.tokens,e||(e=t.numericResponse||t.textResponse||(null!=(r=t.locationResponse)?r.text:void 0)),s.isArray(e)||(e=[e]),e},r.getAnswerCount=function(t,e){return null==e&&(e=_.identity),s(t).reduce(function(t,s){var n,a,i,o;for(o=r.getAnswersFromResponse(s),a=0,i=o.length;i>a;a++)n=o[a],e(n)&&(t[n]||(t[n]=0),t[n]+=1);return t},{})},r.getDistribution=function(t,e){return{aspect:e,distribution:r.getAnswerCount(s(t).where({questionPrompt:e}))}},r.connectionsDistribution=function(t,e){return{aspect:e,distribution:s(t).pluck("connection").map(function(t){return 0===t?"Cell":1===t?"WiFi":"Offline"}).reduce(function(t,e){return t[e]||(t[e]=0),t[e]+=1,t},{})}},r.aggregateWithIndex=function(t,e,r,n){return s(t).reject(function(t){return!r(t)}).groupBy(function(t){return JSON.stringify(e(t))}).pairs().map(function(t){var s,a,i;return i=t[0],a=t[1],s=e(a[0]),a=n(_.map(a,function(t){return r(t)})),_.flatten([s,a])}).value()},r.aggregatePunch=function(t,e,n,a){var i,o;return i=function(t){var e,r,s;return e=_.where(t.responses,{questionPrompt:n}),null!=e?null!=(r=e[0])?null!=(s=r.answeredOptions)?s[0]:void 0:void 0:void 0},o=function(t){return s(t).reduce(function(t,e){return a(e)?t+1:t},0)},r.aggregateWithIndex(t,e,i,o)}},{}],13:[function(t,e){var r,s,n,a,i,o,p,u,c,l,h,d,f;u=t("lodash"),s=t("react"),f=s.DOM,i=f.div,o=f.h2,h=f.p,a=f.button,d=f.select,l=f.option,c=f.label,n=t("./specificCharts"),r=t("./overlay"),p=function(t){return/^Punch/.test(t)},e.exports=s.createClass({displayName:"ChartContainer",mixins:[s.addons.LinkedStateMixin],getDefaultProps:function(){return{width:260,extraClasses:"",overlay:!1}},getInitialState:function(){var t,e,r,s;return e=/^(Yes|No)$/.test(null!=(r=this.props.sample)?null!=(s=r.answeredOptions)?s[0]:void 0:void 0),this.props.chartType||(t=e?"PunchImpetusWeekday":this.props.sample.answeredOptions?"Stacked":"VerticalBars"),{chartType:t,punchChartAble:e}},handleChartTypeChange:function(){return this.setState({chartType:event.target.value})},toggleOverlay:function(){return this.setState({overlay:!this.state.overlay})},render:function(){var t,e,u;return t=n[this.state.chartType]||n.VerticalBars,e=_(n).keys().reject(function(t){return function(e){return p(e)&&!t.state.punchChartAble}}(this)).map(function(t){return l({key:t,value:t},t)}).value(),u=s.addons.classSet({"chart-container":!0,"double":p(this.state.chartType)}),i({className:u},[r({key:"overlay",active:this.state.overlay},[i({key:"main",className:"main"},[a({key:"settings",className:"toggle-settings",onClick:this.toggleOverlay},"Settings"),o({key:"heading"},this.props.aspect),i({key:"chart",className:"chart-box"},[t(this.props,[])])]),i({key:"overlay",className:"overlay"},[a({key:"settings",className:"toggle-settings",onClick:this.toggleOverlay},"Done"),o({key:"heading"},this.props.aspect),h({key:"settings-1"},[c({key:"label"},["Chart Type ",d({key:"select",valueLink:this.linkState("chartType")},e)])])])])])}})},{"./overlay":15,"./specificCharts":16}],14:[function(t,e){var r,s,n,a,i;a=t("lodash"),n=t("react"),i=n.DOM.section,s=t("../reporter/distributions"),r=t("./chartSwitch"),e.exports=n.createClass({displayName:"ChartsView",render:function(){var t,e,n;return n=a(this.props.snapshots).pluck("responses").flatten().value(),e=a(n).pluck("questionPrompt").unique().sort().value(),t=e.map(function(t){return function(e){var s;return s=a.find(n,{questionPrompt:e}),r({key:e,snapshots:t.props.snapshots,aspect:e,responses:n,sample:s})}}(this)),function(e){return function(){var n,a,i;return n="What's your internet connection?",a=s.connectionsDistribution(e.props.snapshots,n).distribution,i={key:n,aspect:n,distribution:a,chartType:"Stacked"},t.push(r(i,[]))}}(this)(),i({},t)}})},{"../reporter/distributions":12,"./chartSwitch":13}],15:[function(t,e){var r,s,n,a;r=t("react"),a=r.DOM,n=a.div,s=a.a,e.exports=r.createClass({displayName:"OverlayContainer",getDefaultProps:function(){return{active:!1}},render:function(){var t;return t=r.addons.classSet({"overlay-container":!0,active:this.props.active}),n({className:t},this.props.children)}})},{}],16:[function(t,e){var r,s,n,a,i;i=t("lodash"),n=t("react"),r=t("../charts"),s=t("../reporter/distributions"),a={},a.Stacked=n.createClass({displayName:"StackedReporterChart",render:function(){var t;return t=this.props.distribution?this.props:i.defaults(s.getDistribution(this.props.responses,this.props.aspect),this.props),r.Stacked(t,[])}}),a.VerticalBars=n.createClass({displayName:"VerticalBarsReporterChart",render:function(){var t;return t=this.props.distribution?this.props:i.defaults(s.getDistribution(this.props.responses,this.props.aspect),this.props),r.VerticalBars(t,[])}}),a.PunchImpetusWeekday=n.createClass({displayName:"PunchImpetusWeekdayReporterChart",getDefaultProps:function(){return{weekdays:["7 Sun","1 Mon","2 Tue","3 Wed","4 Thu","5 Fri","6 Sat"],impetues:["Tapped","Sleeping","Day","Dusk","Dawn"],criteria:"Yes",getIndex:function(){return function(t){var e;return e=new Date(t.date),[e.getDay(),t.reportImpetus]}}(this),entryToLabels:function(t){return function(e){var r,s,n;return s=e[0],n=e[1],r=e[2],[t.props.weekdays[s],t.props.impetues[n],r]}}(this)}},render:function(){var t,e,n,a;return n=this.props.getIndex,t=function(t){return function(e){return e===t.props.criteria}}(this),a=i.filter(this.props.snapshots,function(t){return t.reportImpetus&&i.isString(t.date)}),e=i(s.aggregatePunch(a,n,this.props.aspect,t)).map(this.props.entryToLabels).value(),r.PunchChart({aspect:this.props.aspect,distribution:e,width:560,padding:{l:60,b:30,r:0,t:0}})}}),a.PunchHourWeekday=n.createClass({displayName:"PunchHourWeekdayReporterChart",getDefaultProps:function(){return{weekdays:["7 Sun","1 Mon","2 Tue","3 Wed","4 Thu","5 Fri","6 Sat"],criteria:"Yes",getIndex:function(t){var e;return e=new Date(t.date),[e.getDay(),e.getHours()]},entryToLabels:function(t){return function(e){var r,s,n;return s=e[0],n=e[1],r=e[2],[t.props.weekdays[s],n,r]}}(this)}},render:function(){var t,e,n,a;return n=this.props.getIndex,t=function(t){return function(e){return e===t.props.criteria}}(this),a=i.filter(this.props.snapshots,function(t){return i.isString(t.date)}),e=i(s.aggregatePunch(a,n,this.props.aspect,t)).map(this.props.entryToLabels).value(),r.PunchChart({aspect:this.props.aspect,distribution:e,width:560,padding:{l:60,b:30,r:0,t:0}})}}),e.exports=a},{"../charts":4,"../reporter/distributions":12}]},{},[10]);